<p></p>

<div class="card">
  <div class="ui-grid ui-grid-responsive ui-fluid ui-grid-pad">
    <div class="ui-grid-row">
      <div class="ui-grid-col-2 maxWidth150">Date:</div>
      <div class="ui-grid-col-10">
        <table>
          <tr>
            <td><i class="fa fa-arrow-circle-left linkcursor" (click)="previousDay()"></i></td>
            <td><p-calendar [(ngModel)]="current.day" (ngModelChange)="dateChanged($event)" dateFormat="DD, dd M yy" [readonlyInput]="true"></p-calendar></td>
            <td><i class="fa fa-arrow-circle-right linkcursor" (click)="nextDay()"></i></td>
          </tr>
        </table>
      </div>
    </div>
    <div class="ui-grid-row">
      <div class="ui-grid-col-2 maxWidth150">Template Search:</div>
      <div class="ui-grid-col-10" #searchTemplateField>
        <p-autoComplete [(ngModel)]="currentTemplateString" [suggestions]="autoCompleteResults" (completeMethod)="search($event)" placeholder="Search with any keyword or click to select from recently used templates" (click)="quickSelectPanel.toggle($event,quickSelectPanelAnchor)"></p-autoComplete>
        <div #quickSelectPanelAnchor style="display: table-cell;"></div>
        <p-overlayPanel #quickSelectPanel>
          <div style="width: 960px;">
            <p-dataTable [value]="quickSelectionList" selectionMode="single" (onRowSelect)="quickSelectPanel.hide(); onQuickSelectRow($event);">
              <p-column field="psp"></p-column>
              <p-column field="name"></p-column>
              <p-column field="description"></p-column>
              <p-column field="sales_representative"></p-column>
            </p-dataTable>
          </div>
        </p-overlayPanel>
      </div>
    </div>
  </div>
</div>

<div class="card" *ngIf="currentTemplate">
  <maininput-edit [template]="currentTemplate" [booking]="current" (onCancel)="cancel()" (onSave)="save()"></maininput-edit>
</div>

<p-messages [value]="app.messages"></p-messages>

<div class="card">
<p-dataTable [value]="bookings" [responsive]="true">
    <header>Bookings</header>
    <p-column field="id" header="ID" [style]="{'width':'60'}"></p-column>
    <p-column field="booking_template.psp" header="PSP" [style]="{'width':'140'}"></p-column>
    <p-column field="booking_template.name" header="Name" [style]="{'width':'250'}"></p-column>
    <p-column field="description" header="Description"></p-column>
    <p-column field="sales_representative" header="Sales Contact" [style]="{'width':'100'}"></p-column>
    <p-column field="booking_template.subproject" header="Subproject" [style]="{'width':'100'}"></p-column>
    <p-column [style]="{'width':'80'}">
        <template pTemplate type="header">Hours</template>
        <template let-row="rowData" pTemplate type="body">
          {{formattedHours(row.minutes)}}
        </template>
    </p-column>
    <p-column [style]="{'width':'150'}">
        <template pTemplate type="header">Actions</template>
        <template let-row="rowData" pTemplate type="body">
            <i class="fa ui-icon-edit linkcursor" (click)="edit(row)"></i>
            <i class="fa ui-icon-delete linkcursor" (click)="delete(row)"></i>
        </template>
    </p-column>
    <p-footerColumnGroup>
        <p-row>
            <p-column colspan="6"></p-column>
            <p-column [footer]="formattedTableSum"></p-column>
            <p-column></p-column>
        </p-row>
    </p-footerColumnGroup>
</p-dataTable>
<p-confirmDialog header="Confirmation" icon="fa ui-icon-question-answer" width="425"></p-confirmDialog>
</div>

<div class="card">
    <p-panel [header]="chartsTitle">
    <div class="ui-grid ui-grid-responsive ui-fluid">
      <div class="ui-grid-row">
        <div class="ui-grid-col-4">
          <div class="card"><p-chart type="doughnut" [data]="pieChartDataProjects.data" [options]="pieChartDataProjects.options" width="400" height="200"></p-chart></div>
        </div>
        <div class="ui-grid-col-4">
          <div class="card"><p-chart type="pie" [data]="pieChartDataWorkTime.data" [options]="pieChartDataWorkTime.options" width="400" height="200"></p-chart></div>
        </div>
        <div class="ui-grid-col-4">
          <div class="card"><p-chart type="bar" [data]="barChartWorkTime.data" [options]="barChartWorkTime.options" width="400" height="200"></p-chart></div>
        </div>
      </div>
    </div>
    </p-panel>
</div>
